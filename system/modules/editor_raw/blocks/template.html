<script type="text/x-tmpl" id="tmpl-form">
    <h3>Zone:{%=o.zone%}</h3>
    <form action="" method="post">
        <textarea name="{%=o.zone%}" id="editor-{%=o.zone%}">{%=o.zone_data%}</textarea>
    </form>
    <button class="btn btn-warning" id="zoneupdate_{%=o.zone%}">Update Zone</button>&nbsp;&nbsp;&nbsp;
    <div style="display: inline"class="input-prepend input-append">
        <span class="add-on">History</span>
        <select id="editor-raw-history_{%=o.zone%}"></select>
    </div>
</script>
<script type="text/x-tmpl" id="tmpl-button">
    <button class="btn btn-warning" id="zoneupdate_{%=o.zone%}">Raw HTML</button>
</script>
<script type="text/javascript">
    
        var zones = ["z1", "z2", "z3", "z4", "z5", "z6", "z7", "z8", "z9", "z10", "z11", "z12"];
        var zone_content = {
            z1:"", 
            z2:"", 
            z3:"", 
            z4:"", 
            z5:"", 
            z6:"", 
            z7:"", 
            z8:"", 
            z9:"", 
            z10:"", 
            z11:"", 
            z12:""
        };
        var raw_editor_open = false;
        
        function enable_raw_zones(closeall){
            if(closeall){
                console.log('closeall');
                for (x in zones){
                    $('#'+zones[x]).raweditor('close');
                }
            }else{
                if(raw_editor_open){
                    $('#raw-edit-button').html("Enable Raw Editor");
                    raw_editor_open = false;
                }else{
                    $('#raw-edit-button').html("Disable Raw Editor");
                    raw_editor_open = true;
                }
                var pid = "{pid}";
                for (x in zones){
                    $('#'+zones[x]).raweditor('toggle', pid);
                }
            }
        }
    $(document).ready(function() {
        $("#raw-edit-button").click(function() {
            enable_raw_zones();
        });
        /*
        $("#raw-edit-button").change(function() {
            enable_raw_zones();
        });
        */
        for (x in zones){
            if(zone_content[zones[x]] == ''){
                var content = $("#"+zones[x]).html();
                zone_content[zones[x]] = content;
            }
        }
    });
    
</script>
<script src="{root_doc}system/modules/editor_raw/assets/jquery.raweditor.js" type="text/javascript"></script>